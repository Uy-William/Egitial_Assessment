{"ast":null,"code":"import _asyncToGenerator from\"D:/Will/Egitial_Assessment/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"D:/Will/Egitial_Assessment/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _taggedTemplateLiteral from\"D:/Will/Egitial_Assessment/client/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";var _templateObject,_templateObject2,_templateObject3;import _regeneratorRuntime from\"D:\\\\Will\\\\Egitial_Assessment\\\\client\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import React,{useState,useEffect,useContext}from\"react\";import{useQuery,useMutation}from\"@apollo/react-hooks\";import gql from\"graphql-tag\";import AuthContext from\"../auth/AuthProvider\";import{useNavigate,useLocation}from\"react-router-dom\";import{Button,Dialog,DialogTitle,DialogContent,DialogActions}from\"@mui/material/\";import HomeIcon from'@mui/icons-material/Home';import\"./question.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var ADD_SOCRE=gql(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  mutation enterAnswer($earningpoints: String!, $userid: String!) {\\n    enterAnswer(earningpoints: $earningpoints, userid: $userid) {\\n      earningpoints\\n    }\\n  }\\n\"])));function Question(){var location=useLocation();var navigate=useNavigate();var _useState=useState(0),_useState2=_slicedToArray(_useState,2),currentQuestion=_useState2[0],setCurrentQuestion=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),score=_useState4[0],setScore=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),showAnswer=_useState6[0],setshowAnswer=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),final=_useState8[0],setFinal=_useState8[1];var _useState9=useState(null),_useState10=_slicedToArray(_useState9,2),answerCorrect=_useState10[0],setAnswerCorrect=_useState10[1];var _useState11=useState(\"\"),_useState12=_slicedToArray(_useState11,2),userData=_useState12[0],setUserData=_useState12[1];var _useState13=useState(15),_useState14=_slicedToArray(_useState13,2),seconds=_useState14[0],setSeconds=_useState14[1];var _useState15=useState(true),_useState16=_slicedToArray(_useState15,2),isRunning=_useState16[0],setisRunning=_useState16[1];var _useContext=useContext(AuthContext),setAuth=_useContext.setAuth;var QUESTION_API=gql(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n    {\\n      questions {\\n        id\\n        description\\n        answer {\\n          id\\n          option\\n          isCorrect\\n        }\\n      }\\n    }\\n  \"])));// Run and fetch the data on the query\nvar _useQuery=useQuery(QUESTION_API),loading=_useQuery.loading,_useQuery$data=_useQuery.data;_useQuery$data=_useQuery$data===void 0?{}:_useQuery$data;var Quest=_useQuery$data.questions;var ADD_SCORE=gql(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\\n    mutation enterAnswer($earningpoints: String!, $userid: String) {\\n      enterAnswer(earningpoints: $earningpoints, userid: $userid) {\\n        earningpoints\\n      }\\n    }\\n  \"])));var _useMutation=useMutation(ADD_SOCRE,{update:function update(proxy,result){// console.log(result);\n},variables:{earningpoints:\"100\",userid:userData.userData}}),_useMutation2=_slicedToArray(_useMutation,2),addAnswer=_useMutation2[0],load=_useMutation2[1].load;useEffect(function(){if(isRunning){var time=setInterval(function(){setSeconds(function(seconds){return seconds-1;});if(seconds===0&&seconds>=-1){if(currentQuestion>=4){setFinal(true);setisRunning(false);clearInterval(time);}else{setCurrentQuestion(function(currentQuestion){return currentQuestion+1;});setSeconds(15);}}},1000);return function(){return window.clearInterval(time);};}});var HomeRoute=function HomeRoute(){navigate('/');};// a function to close the modal\n// const modalOff = () => {\n//   setFinal(false)\n// }\nvar checkAnswer=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(isCorrect){var nextQuestion;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(isCorrect){setAnswerCorrect(true);setUserData(location.state.userid);addAnswer();setScore(score+100);}else{setAnswerCorrect(false);}nextQuestion=currentQuestion+1;if(nextQuestion<Quest.length){setSeconds(15);setCurrentQuestion(nextQuestion);setshowAnswer(true);}else{setFinal(true);setisRunning(false);}case 3:case\"end\":return _context.stop();}}},_callee);}));return function checkAnswer(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsx(_Fragment,{children:loading?/*#__PURE__*/_jsx(\"h2\",{children:\"fetching data!\"}):/*#__PURE__*/_jsx(\"div\",{children:final?/*#__PURE__*/_jsxs(Dialog,{open:final// onClose={modalOff} once clicks at the background outside the modal will close the modal\n,children:[/*#__PURE__*/_jsx(DialogTitle,{children:\"Congratulations!\"}),/*#__PURE__*/_jsxs(DialogContent,{children:[/*#__PURE__*/_jsx(\"p\",{children:\"You have finished on taking the quiz, and your final score is.\"}),/*#__PURE__*/_jsxs(\"h3\",{className:\"scoreStyle\",children:[score,\" / 500\"]})]}),/*#__PURE__*/_jsx(DialogActions,{children:/*#__PURE__*/_jsxs(Button,{onClick:HomeRoute,children:[/*#__PURE__*/_jsx(HomeIcon,{}),\"Home\"]})})]}):/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(Dialog,{open:!final// onClose={modalOff} once clicks at the background outside the modal will close the modal\n,children:[/*#__PURE__*/_jsxs(DialogTitle,{children:[\"Question: \",currentQuestion+1,\" / \",Quest.length,\" | \",seconds,\"s Left\",showAnswer?/*#__PURE__*/_jsxs(\"p\",{style:answerCorrect?{color:\"green\"}:{color:\"red\"},children:[\"| \",answerCorrect?\"Correct!\":\"Wrong!\"]}):/*#__PURE__*/_jsx(_Fragment,{})]}),/*#__PURE__*/_jsx(DialogContent,{children:Quest[currentQuestion].description}),/*#__PURE__*/_jsx(DialogActions,{children:Quest[currentQuestion].answer.map(function(answers){return/*#__PURE__*/_jsx(Button,{variant:\"contained\",className:\"answerButton\",value:answers.id,onClick:function onClick(){return checkAnswer(answers.isCorrect);},children:answers.option},answers.id);})})]})})})});}export default Question;","map":{"version":3,"sources":["D:/Will/Egitial_Assessment/client/src/pages/question/question.js"],"names":["React","useState","useEffect","useContext","useQuery","useMutation","gql","AuthContext","useNavigate","useLocation","Button","Dialog","DialogTitle","DialogContent","DialogActions","HomeIcon","ADD_SOCRE","Question","location","navigate","currentQuestion","setCurrentQuestion","score","setScore","showAnswer","setshowAnswer","final","setFinal","answerCorrect","setAnswerCorrect","userData","setUserData","seconds","setSeconds","isRunning","setisRunning","setAuth","QUESTION_API","loading","data","Quest","questions","ADD_SCORE","update","proxy","result","variables","earningpoints","userid","addAnswer","load","time","setInterval","clearInterval","window","HomeRoute","checkAnswer","isCorrect","state","nextQuestion","length","color","description","answer","map","answers","id","option"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useContext } from \"react\";\r\nimport { useQuery, useMutation } from \"@apollo/react-hooks\";\r\nimport gql from \"graphql-tag\";\r\nimport AuthContext from \"../auth/AuthProvider\";\r\nimport { useNavigate, useLocation } from \"react-router-dom\";\r\n\r\nimport {\r\n  Button,\r\n  Dialog,\r\n  DialogTitle,\r\n  DialogContent,\r\n  DialogActions,\r\n} from \"@mui/material/\";\r\n\r\nimport HomeIcon from '@mui/icons-material/Home';\r\n\r\nimport \"./question.css\";\r\n\r\nconst ADD_SOCRE = gql`\r\n  mutation enterAnswer($earningpoints: String!, $userid: String!) {\r\n    enterAnswer(earningpoints: $earningpoints, userid: $userid) {\r\n      earningpoints\r\n    }\r\n  }\r\n`;\r\n\r\nfunction Question() {\r\n  const location = useLocation();\r\n  const navigate = useNavigate();\r\n\r\n  const [currentQuestion, setCurrentQuestion] = useState(0);\r\n  const [score, setScore] = useState(0);\r\n  const [showAnswer, setshowAnswer] = useState(false);\r\n  const [final, setFinal] = useState(false);\r\n  const [answerCorrect, setAnswerCorrect] = useState(null);\r\n\r\n  const [userData, setUserData] = useState(\"\");\r\n\r\n  const [seconds, setSeconds] = useState(15);\r\n  const [isRunning, setisRunning] = useState(true);\r\n\r\n  const { setAuth } = useContext(AuthContext);\r\n\r\n  const QUESTION_API = gql`\r\n    {\r\n      questions {\r\n        id\r\n        description\r\n        answer {\r\n          id\r\n          option\r\n          isCorrect\r\n        }\r\n      }\r\n    }\r\n  `;\r\n\r\n  // Run and fetch the data on the query\r\n  const { loading, data: { questions: Quest } = {} } = useQuery(QUESTION_API);\r\n\r\n  const ADD_SCORE = gql`\r\n    mutation enterAnswer($earningpoints: String!, $userid: String) {\r\n      enterAnswer(earningpoints: $earningpoints, userid: $userid) {\r\n        earningpoints\r\n      }\r\n    }\r\n  `;\r\n\r\n  const [addAnswer, { load }] = useMutation(ADD_SOCRE, {\r\n    update(proxy, result) {\r\n      // console.log(result);\r\n    },\r\n    variables: {\r\n      earningpoints: \"100\",\r\n      userid: userData.userData,\r\n    },\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (isRunning) {\r\n      const time = setInterval(() => {\r\n        setSeconds((seconds) => seconds - 1);\r\n        if (seconds === 0 && seconds >= -1) {\r\n          if (currentQuestion >= 4) {\r\n            setFinal(true);\r\n            setisRunning(false);\r\n            clearInterval(time);\r\n          } else {\r\n            setCurrentQuestion((currentQuestion) => currentQuestion + 1);\r\n            setSeconds(15);\r\n          }\r\n        }\r\n      }, 1000);\r\n      return () => window.clearInterval(time);\r\n    }\r\n  });\r\n\r\n  const HomeRoute = () => {\r\n    navigate('/');\r\n  }\r\n\r\n  // a function to close the modal\r\n  // const modalOff = () => {\r\n  //   setFinal(false)\r\n  // }\r\n\r\n  const checkAnswer = async (isCorrect) => {\r\n    if (isCorrect) {\r\n      setAnswerCorrect(true);\r\n      setUserData(location.state.userid);\r\n      addAnswer();\r\n      setScore(score + 100);\r\n    } else {\r\n      setAnswerCorrect(false);\r\n    }\r\n\r\n    const nextQuestion = currentQuestion + 1;\r\n    if (nextQuestion < Quest.length) {\r\n      setSeconds(15);\r\n      setCurrentQuestion(nextQuestion);\r\n      setshowAnswer(true);\r\n    } else {\r\n      setFinal(true);\r\n      setisRunning(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      {loading ? (\r\n        <h2>fetching data!</h2>\r\n      ) : (\r\n        <div>\r\n          {final ? (\r\n            <Dialog\r\n              open={final}\r\n              // onClose={modalOff} once clicks at the background outside the modal will close the modal\r\n            >\r\n              <DialogTitle>{\"Congratulations!\"}</DialogTitle>\r\n              <DialogContent>\r\n                <p>\r\n                  You have finished on taking the quiz, and your final score is.\r\n                </p>\r\n                <h3 className=\"scoreStyle\">{score} / 500</h3>\r\n              </DialogContent>\r\n              <DialogActions>\r\n                <Button onClick={HomeRoute}>\r\n                  <HomeIcon />\r\n                  Home\r\n                </Button>\r\n              </DialogActions>\r\n            </Dialog>\r\n          ) : (\r\n            <>\r\n              <Dialog\r\n                open={!final}\r\n                // onClose={modalOff} once clicks at the background outside the modal will close the modal\r\n              >\r\n                <DialogTitle>\r\n                  Question: {currentQuestion + 1} / {Quest.length} | {seconds}s\r\n                  Left\r\n                  {showAnswer ? (\r\n                    <p\r\n                      style={\r\n                        answerCorrect ? { color: \"green\" } : { color: \"red\" }\r\n                      }\r\n                    >\r\n                      | {answerCorrect ? \"Correct!\" : \"Wrong!\"}\r\n                    </p>\r\n                  ) : (\r\n                    <></>\r\n                  )}\r\n                </DialogTitle>\r\n                <DialogContent>\r\n                  {Quest[currentQuestion].description}\r\n                </DialogContent>\r\n                <DialogActions>\r\n                  {Quest[currentQuestion].answer.map((answers) => {\r\n                    return (\r\n                      <Button\r\n                        variant=\"contained\"\r\n                        className=\"answerButton\"\r\n                        value={answers.id}\r\n                        onClick={() => checkAnswer(answers.isCorrect)}\r\n                        key={answers.id}\r\n                      >\r\n                        {answers.option}\r\n                      </Button>\r\n                    );\r\n                  })}\r\n                </DialogActions>\r\n              </Dialog>\r\n            </>\r\n          )}\r\n        </div>\r\n      )}\r\n    </>\r\n  );\r\n}\r\n\r\nexport default Question;\r\n"]},"metadata":{},"sourceType":"module"}